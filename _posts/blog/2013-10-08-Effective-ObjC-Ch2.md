---
layout:    post
title:     Effective Objective-C 2.0 Chapter 2
category:  blog
description: 对象，消息，和运行时
tags: ObjC
---
# 第2章 对象，消息，和运行时
对象在诸如 Objective-C 这样的面向对象语言中是程序的构件，提供了一个存储搬运数据的方法。消息是对象间相互对话以搬运数据，产生行为的过程。深入理解对象和消息这两个特性是构建高效和可维护代码的关键。

Objective-C 运行时是应用运行时，才提供给语言使用的代码。运行时提供使得在对象间发送消息成为可能，和类的实例如何创建背后的所有逻辑的这样的关键功能。理解这些能使你成为一个更好的开发者。

## 条目 6：理解属性（Properties）

* @property 语法提供了一种定义对象封装何种数据的方法。

* 使用类变量为被存储的数据提供正确语言。
 
* 确定任何属性背后的实例变量被赋值了，声明语义都被实现了。

* 在 iOS 中使用 nonatomic，因为如果使用 atomic，性能会受严重影响。


## 条目 7：在对象内部访问实例变量，主要采用直接访问的形式

* 推荐内部直接读取实例变量，和通过属性向实例变量写数据。

* 在构造器和 dealloc 中，总是直接读写实例变量。

* 有时，在数据被延迟初始化时，你会需要通过属性读取数据。


## 条目 8：理解对象相等

* 为你将要做相等性检查的对象提供 isEqual: 和 hash 方法。

* 相等对象必须有相同的哈希值，但是有相同哈希的对象并必须要相等。

* 确定哪些属性是测试相等性所必须的，而不是简单粗暴地检查所有属性。

* 编写的 hash 方法必须快速，同时提供一个合理的低冲突概率。


## 条目 9：使用类簇模式隐藏实现细节

## 条目 10：通过关联对象（Associated Object）将用户数据挂载在已有类上

* 关联对象提供了一种将两个对象联系在一起的方法。
* 关联对象的内存管理语义可以被定义为类似拥有或不拥有关系。
* 关联对象只应该在其它方法都不能用时才被使用，因为它们很容易导致难以调试的 bug。

## 条目 11：理解 objc_msgSend 的角色
* 一条消息由接收者，选择器，参数构成。调用消息是在对象中调用方法的同义词。
* 当被调用时，所有消息将通过动态消息分发系统，这样消息的实现部分会被查找到并被运行。


## 条目 12：理解消息转发
* 消息转发时一个对象在被发现无法回应一个选择器时所需经历的过程
* 动态方法解析被用于在运行时向类添加方法
* 对象可以声明其它对象来处理它所不能处理的特定选择器
* 完全转发只发生在上述处理选择器的方法都没使用的情况下

## 条目 13：考虑使用 Swizzling 方法调试黑箱方法

* 类的某个选择器的方法实现可以在运行时被添加和替换。
* Swizzling 是将一个方法的实现和另一个替换的过程，通常会在原来实现上添加功能。
* 运行时干预方法通常只在调试时是好注意，不应仅因能够这么做而滥用。

## 条目 14：理解 Class 对象是什么

* 类继承层次通过 Class 对象反映，它的实例有一个指向其自身类型的指针。
* 自省应该在对象的类型在编译时无法知道时使用。
* 自省方法在任何可能被使用到的地方总是优于直接比较对象的类型，因为对象也许实现了消息转发。
